<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="data.mapper.CartMapper">
  <insert id="insertCart" parameterType="cartdto">
    INSERT INTO bit_final.cart (user_idx,shop_num,shop_option,shop_qty,shop_price)
     VALUES((select idx from usersjoin where id = #{user_id}), #{shop_num}, #{shop_option}, #{shop_qty}, #{shop_price})
  </insert>
  <select id="listCart" parameterType="String" resultType="cartdto">
    SELECT
           s.title,
           s.uploadfile,
           s.name,
           c.shop_option ,
           c.shop_qty ,
           c.shop_price
    from cart c inner join usersjoin u on c.user_idx = u.idx
                inner join shopboarder s on c.shop_num = s.num
    where user_idx = (SELECT idx from usersjoin where id = #{user_id});
  </select>
  <delete id="deleteCart" parameterType="cartdto">
    DELETE FROM bit_final.cart WHERE user_idx = #{user_idx} &amp;&amp; shop_option like #{shop_option};
  </delete>
  <delete id="deleteAllCart" parameterType="int">
    DELETE FROM bit_final.cart WHERE user_idx = #{user_idx};
  </delete>
</mapper>